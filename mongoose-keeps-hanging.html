
<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<title>How to test React components using Karma and webpack – Nicolas Gallagher</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<meta property="og:title" content="How to test React components using Karma and webpack – Nicolas Gallagher" />
<meta property="og:description" content="One way to combine these popular tools to support unit testing">
<meta property="twitter:account_id" content="24974216">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@necolas">
<meta name="twitter:creator" content="@necolas">


<!--[if IE 8]><script src="/html5.d401792972cc77413e83a6fe2f94fee3.js"></script><![endif]-->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,700">
<link rel="stylesheet" href="/MyStyle.css">

<header class="Header" role="banner">
  <div class="Container">
    <div class="Header-logo">
      <a href="/">
        <img src="http://www.gravatar.com/avatar/9eecfabc23fd999927fa7989a7eaff5f.png?v=2&amp;s=50" width="50" height="50" alt="">
        <span class="Header-prompt">Read more posts</span>
      </a>
    </div>
    
  </div>
</header>


<div class="Content" role="main">
  

<style>
  .Article-coverImage {
    
    
    
  }
</style>

<article class="Article">
  <div class="Container">
    <header class="Article-header">
      <div class="Article-data">
        <time class="Article-timestamp Timestamp" datetime="2015-05-17">May 17, 2015</time>
      </div>
      <h1 class="Article-title">Mongooze</h1>
      
      <div class="HzLine"></div>
      
    </header>
  </div>

  

  <div class="Container">
    <div class="Article-body">
      <p>I’m working on a project at Twitter that uses React and webpack. After a few
conversations with <a href="https://github.com/sokra">@sokra</a> last year, this is the
setup I put in place for testing React components (authored using JSX and ES6)
using Karma.</p>
<h2 id="dependencies">Dependencies</h2>
<p>You’ll need to install various packages. It looks like a lot of dependencies,
but all the non-Karma packages will be necessary for general module bundling
during development.</p>
<p>Full set of required packages:</p>
<ul>
<li><a href="https://www.npmjs.com/package/babel">babel-core</a>: to transform JSX and transpile ES6.</li>
<li><a href="https://www.npmjs.com/package/babel-loader">babel-loader</a>: webpack loader for Babel.</li>
<li><a href="https://www.npmjs.com/package/karma">karma</a>: the test runner.</li>
<li><a href="https://www.npmjs.com/package/karma-chai-plugins">karma-chai-plugins</a>: assertion library (or your library of choice).</li>
<li><a href="https://www.npmjs.com/package/karma-chrome-launcher">karma-chrome-launcher</a>: Chrome browser launcher.</li>
<li><a href="https://www.npmjs.com/package/karma-cli">karma-cli</a>: CLI tool for Karma.</li>
<li><a href="https://www.npmjs.com/package/karma-mocha">karma-mocha</a>: adapter for the Mocha testing framework.</li>
<li><a href="https://www.npmjs.com/package/karma-sourcemap-loader">karma-sourcemap-loader</a>: sourcemap loader.</li>
<li><a href="https://www.npmjs.com/package/karma-webpack">karma-webpack</a>: to use webpack with Karma.</li>
<li><a href="https://www.npmjs.com/package/react">react</a></li>
<li><a href="https://www.npmjs.com/package/webpack">webpack</a>: module bundler</li>
</ul>
<h2 id="webpack-entry-file">webpack entry file</h2>
<p></p>

<p>We have encountered this issue in all our environments. (dev/intg/stg/prod)
At NI we have a very large NodeJS application which is backed up by a MongoDB servers which runs in a cluster of replica set.
This problem happens when our mongo db goes down.
This can be caused by various failures like: system administrator mistake or server shutdown, power interrupt etc …
Connection failures and retries with mongoDB are a known issue that causes confusion among developers how exactly the mongo db driver works when it comes to socket timeouts and retries.
If for some reason the database/replica set goes down then the application starts to hang.
This issue is caused by the internal implementation of Mongoose (version 4.7.2) which wraps the mongo db driver. (version 2.1.12)
There are couple of settings that the user needs to be aware of that are causing the hang:
autoReconnect setting
this setting should be set to false in the db section of the config options
2. bufferMaxEntries setting
this setting should be set to 0 in the db section of the config options
bufferCommands setting
This setting controls the buffering at the schema level and should be set at the schema level only when running in replicaset mode
Each of this setting has in-depth knowledge concerning how to set it and the pros and cons of each setting.
According to Mongo DB the best practice recommend to create one connection per db and to keep your connection alive and open along as your application runs.
For more information about connection failures please read this from mongoDB site.</p>

      
      <div class="Article-tweet">
        
<a class="twitter-share-button"
   rel="external nofollow"
   title="Share this on Twitter"
   href="http://twitter.com/share?text==Mongoose keeps hanging&amp;url=http%3A%2F%2Ftalavissar.com%2Fmongoose-keeps-hanging%2F&amp;counturl=http%3A%2F%talavissar.com%2Fhow-to-test-react-components-karma-webpack%2F&amp;via=necolas&amp;count=none&amp;size=medium"
   target="_blank">Tweet</a>

      </div>
    </div>
  </div>

  

</article>


</div>

<footer class="Footer" role="contentinfo">
  <div class="Container">
    <div class="HzLine"></div>
    <a class="twitter-follow-button" href="//twitter.com/talaviss" data-show-count="false" data-lang="en" data-size="large">Follow @talaviss</a>
    <p class="Footer-links">
      <a href="/about/">About</a>
      &middot;
      <a href="//twitter.com/talaviss">Twitter</a>
      <a href="//medium.com/@talaviss">Medium</a>
      <a href="//github.com/talaviss">GitHub</a>
    </p>
    <small class="Footer-legal">Copyright &#169; Tal Avissar.</small>
  </div>
</footer>

